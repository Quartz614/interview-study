![image](https://user-images.githubusercontent.com/96826217/212474776-466ab3c8-62c5-4b83-ae88-c27b889a3edf.png)


## **🔎 스프링 컨테이너란❓**

스프링 컨테이너는 자바 객체의 생명 주기를 관리하고 생성된 자바 객체들에게 추가적인 기능을 제공하는 역할을 한다. 자바 객체를 스프링에서는 빈(Bean)으로 부르고 IoC와 DI의 원리가 이 스프링 컨테이너에서 적용된다.

개발자가 new 연산자, 인터페이스 호출, 팩토리 호출 방식으로 객체를 생성하고 소멸시키는 것들을 스프링 컨테이너가 대신 수행해준다. 제어의 흐름을 외부에서 관리를 해주는 것이다. 그리고 객체들 간의 의존 관계를 스프링 컨테이너가 알아서 만들어 준다. 

### ⚈ **스프링 컨테이너의 종류**

#### (1) BeanFactory

-   빈을 등록하고 생성, 조회, 반환과 그 외에 부가적인 빈을 관리하는 기능을 담당한다.
-   빈 펙토리가 빈의 정의는 즉시 로딩하는 반면, 요청이 있기까지 인스턴스화를 하지 않는다.
-   getBean()이 호출이 되어야 의존성 주입을 이용해 빈을 인스턴스화하고 빈의 생명주기가 시작된다.

(2) ApplicationContext

-   BeanFactory를 상속, 확장한 향상된 컨테이너이다.
-   컨텍스트 초기화 시점에 모든 싱글톤 빈을 미리 생성하기 때문에 인스턴스를 즉시 사용하게 보장해준다.
-   기본적인 기능은 빈 팩토리와 동일하고 스프링이 제공하는 각종 부가 서비스를 추가로 제공한다.

---

## **🔎 스프링 빈이란❓**

스프링은 보통 스프링 컨테이너에 빈 인스턴스를 단 한개만 저장하는 싱글톤 방식을 채택하고 있다. 빈 이름은 항상 다르게 지정이 되어야 한다. 예상치 못한 여러 오류가 발생하면 이를 개발 중 발견하기 매우 어렵기 때문이다.

#### 

### ⚈ **스프링 빈을 등록하는 방법**

#### (1) 컴포넌트 스캔

@Component Annotation을 통해 등록이 가능하며, 그 이외에도 스프링 프레임워크에서 제공하는 @Controller나 @Service 혹은 @Repository와 같은 Annotation은 아래와 같은 인터페이스로 @Component Annotation을 받기 때문에 컴포넌트 등록이 가능하다.

```
...
@Component
public @interface Service {
	...
}
```

단, 실행되는 패키지와 같은 패키지에 있는 클래스에 대해서만 @Component Annotaion이 적용된다.

#### (2) 스프링 빈 직접 등록

스프링 빈을 직접 등록하는 것은 @Configuration과 @Bean Annotaion으로 가능하다.

```
@Configuration
public class SpringConfig {
   @Bean
   public MemberService memberService() {
       return new MemberService(memberRepository());
   }
}
```

### ⚈ **스프링 빈의 생명주기**

스프링 빈은 스프링 컨테이너 내부에서 생성되고, 스프링이 종료되기 전까지 생명주기(Life-Cycle)을 가지고 있는데 이때, 스프링은 객체 생성 -> 의존관계 주입의 라이프 사이클을 가진다.

### ⚈ **스프링 빈의 이벤트 라이프 사이클**

스프링 내부에서는 스프링의 라이프 사이클과 관련하여 이벤트가 있는데 순서는

스프링 컨테이너 생성 -> 스프링 빈 생성 -> 의존관계 주입 -> 초기화 콜백(EVENT) -> 앱 본연의 동작 수행 -> 소멸전 콜백(EVENT) -> 스프링 종료

👉 스프링 컨테이너가 가동되고 본격적으로 앱이 동작하기 전에 한번, 스프링이 종료되기 전에 한번 특정한 동작을 수행할 수 있는 이벤트가 존재한다. 이러한 이벤트에서 초기화 콜백을 이용하여 테스트로 사용할 데이터를 앱의 사전 동작 전에 미리 저장한다던지, 소멸전 콜백을 이용하여 사고에 가깝게 스프링이 종료되는 상황에서 데이터를 백업하는 등의 동작을 수행할 수 있다.

### ⚈ **스프링 빈 스코프**

스프링은 빈이라는 개념으로 객체를 만들고 싱글톤화 시켜 관리해준다. 이 빈으로 생성된 객체들은 스프링 컨테이너와 함께 시작되고 종료될 때까지 스프링이 관리해주는데 스프링 빈들은 싱글톤 스코프로 관리되기 때문이다.

여기서 빈 스코프의 의미는 빈이 관리되는 범위를 뜻한다.

스프링이 가지는 스코프는 싱글톤, 프로토 타입, 웹 관련 스코프가 있다.

-   싱글톤 : 기본 스코프, 스프링 컨테이너의 시작과 종료까지 유지되는 가장 넓은 범위의 스코프이다.
-   프로토 타입: 스프링 컨테이너는 프로토 타입 빈의 생성과 의존관계 주입까지만 관여하고 더는 관리하지 않는 매우 짧은 범위의 스코프이다.
-   웹 관련 스코프 - request: 웹 요청이 들어오고 나갈때 까지 유지되는 스코프, session: 웹 세션이 생성되고 종료될 때 까지 유지되는 스코프, application: 웹의 서블릿 컨텍스와 같은 범위로 유지되는 스코프이다.

#### 싱글톤 및 프로토 타입 스코프 등록 방법

```
@Component
public class TestBean{
	...
}
```

싱글톤 스코프의 경우 위와 같이 @Component로 등록을 해놓으면 디폴트 값이기 때문에 저렇게만 해놓아도 자동으로 등록된다.

프로토타입 스코프는 자동과 수동으로 등록하는 방법이 있다.

#### 프로토 타입 스코프 자동 등록하기

```
@Scope("prototype")
@Component
public class TestBean{
	...
}
```

자동 등록의 경우 @Scope로 해놓고 prototype을 명시해놓으면 된다.

#### 프로토 타입 스코프 수동 등록하기

```
@Scope("prototype")
@Bean
public class TestBean{
	
    PrototypeBean TestBean(){
    	return new TestBean();
    }
}
```

수동 등록의 경우에는 @Bean, @Scope를 명시한 다음 생성자로 PrototypeBean을 반환하면 된다.

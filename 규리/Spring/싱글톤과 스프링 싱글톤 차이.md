2023/01/18

### 🧑‍💻 **기술블로깅 TechBlog** 🪚

<aside>
💡 Singleton vs Spring Singleton

</aside>

* 공부를 위해서 하는 블로깅으로 잘못된 정보가 있을 수 있습니다.

<br><br>

## [ Spring ] **싱글톤과 스프링 싱글톤 차이**

**🔩 싱글톤**

---

Singleton

**객체의 인스턴스가 오직 1개만 생성되는 패턴**

```java
public class Singleton {

    private static Singleton instance = new Singleton();
    
    private Singleton() {
        // 생성자는 외부에서 private으로 지정
    }

    public static Singleton getInstance() {
        return instance;
    }

    public void say() {
        System.out.println("hi, there");
    }
}
```

특정 세션에 대해 하나의 데이터베이스 연결만 존재해야 하고, 여러 모듈에서 공유되고 있는 글로벌 속성 집합을 참조하는 개체의 경우, Application에서 특정 클래스에 대해 하나의 객체만 존재해야 하기 때문에 싱글톤으로 구현

<br><br>

**+ 싱글톤 특징**

---

- classloader 단위
- 싱글톤 클래스라고 하면 해당 클래스의 인스턴스를 하나만 만들수 있음
- 외부 클래스로부터 인스턴스화 되는 것을 막기 위해 생성자 `private`으로 선언
- 인스턴스화 된 클래스를 static 변수로 선언
- 인스턴스화 된 클래스를 리턴하는 함수 선언

<br><br>

**+ 싱글톤 문제점**

---

- `private`으로 인한 상속 불가능
    
    상속을 통한 다형성 적용이 불가능
    
- 작성하기 어려운 테스트
    
    Mock 객체로 대체하기 어렵고, 동적으로 객체를 주입하기도 어려움
    
- 서버 환경에서는 싱글톤이 한 개만 생성되는 것을 보장하지 못함
    
    클래스 로더 구성에 따라 한 개 이상의 객체가 만들어질 수 있음
    
    JVM에 분산되어 설치할 경우 독립적으로 객체 생성
    
- 전역상태를 만들 수 있음
    
    싱글톤을 구현하기 위해 static 필드/static 메서드 사용 → 객체지향적이지 못함
    

<br><br>

**🔩 스프링 싱글톤**

---

Spring Singleton

**객체 호출 시 매번 객체를 생성하지않고, 이미 생성된 객체 하나를 재사용하는 것**

Bean의 관리주체인 스프링 컨테이너에서 딱 한 개의 인스턴스를 만들고 설정 정보에 의해서 관리하는 것

<br><br>

**+ 싱글톤 특징**

---

- `private`이 필요하지 않아 상속 가능
- 간편한 테스트
- 프레임워크를 통해 한 개의 객체 생성 보장
- 객체지향적 개발

<br><br>

**🔩 싱글톤 vs 스프링 싱글톤**

---

- Java 싱글톤은 클래스 로더에 의해 구현, 스프링 싱글톤은 스프링 컨테이너에 의해 구현
- Java 싱글톤의 scope는 코드 전체, 스프링 싱글톤의 scope는 해당 컨테이너 내부
- 스프링에 의해 구현된 싱글톤패턴은 Thread Safety를 자동으로 보장, Java 싱글톤의 경우 구현하는 개발자의 로직에 따라 보장할 수도 않을 수도 있음

<br><br>

🔩 **예비 답변**

---

Q. 싱글톤에 대해 말해보세요.

자바 싱글톤은 객체의 인스턴스가 오직 1개만 생성되는 패턴으로, 애플리케이션에서 특정 클래스에 대해 하나의 객체만 존재해야할 때 싱글톤으로 구현합니다.

싱글톤의 경우 외부 클래스로부터 인스턴스화 되는 것을 막기 위해 생성자 `private`을 선언하는데, 이로 인해 상속이 불가능하여 다형성 적용 역시 불가능하다는 문제가 발생합니다. 또한 테스트가 어려우며 서버 환경에서는 싱글톤이 한 개만 생성되는 것을 보장받지 못한다는 문제도 있습니다.

<br>

Q. 스프링 싱글톤에 대해 말해보세요.

스프링 싱글톤은 객체 생성을 스프링에 위임하여 Bean의 관리주체인 스프링 컨테이너에서 딱 한 개의 인스턴스를 만들고 설정 정보에 의해서 관리하는 것입니다. 

자바 언어 레벨에서 직접 구현하기 때문에 private 생성자나 테스트 코드 작성, 한 개의 객체 생성 보장 등의 싱글톤의 단점을 해결할 수 있습니다.

<br>

Q. 싱글톤과 스프링 싱글톤의 차이에 대해 말해보세요.

자바 싱글톤은 클래스 로더에 의해 구현되는 반면, 스프링 싱글톤은 스프링 컨테이너에 의해 구현됩니다.

자바 싱글톤의 scope는 코드 전체이고, 스프링 싱글톤의 scope는 해당 컨테이너 내부이며,

스프링에 의해 구현된 싱글톤패턴은 Thread Safety를 자동으로 보장하지만, Java 싱글톤의 경우 구현하는 개발자의 로직에 따라 보장할 수도 않을 수도 있다는 차이점이 있습니다.

<br><br>

🔩 **참고**

---

블로그

[싱글톤(Singleton) 패턴이란?](https://tecoble.techcourse.co.kr/post/2020-11-07-singleton/)

[자바 싱글톤 vs 스프링 싱글톤의 차이점](https://judekim.tistory.com/91)

[스프링(Spring): 싱글톤(Singleton) 패턴](https://taehoung0102.tistory.com/73)

<br><br>

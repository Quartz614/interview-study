2023/01/16

### 🧑‍💻 **기술블로깅 TechBlog** 🪚

<aside>
💡 Multi Thread vs Multi Process

</aside>

* 공부를 위해서 하는 블로깅으로 잘못된 정보가 있을 수 있습니다.

<br><br>

## [ OS ] 멀티 스레드 vs 멀티 프로세스

**🔩 멀티 스레드** Multi Thread

---

**하나의 프로세스를 여러 개의 스레드로 구성하여 자원을 공유하며 작업을 수행하는 것**

하나의 작업을 위해 프로세스에서 여러 스레드를 생성해 여러 CPU코어를 사용하기 위한 작업

<br><br>

**+ 멀티 스레드 장점**

---

- 스레드 사이 작업량이 적어 *Context Switching이 빠름* (캐시 메모리를 비울 필요가 없음)
- 시스템 자원 소모가 감소하여 자원의 효율성이 증대
- 프로세스를 생성하여 자원을 할당하는 시스템 콜이 줄어 자원의 효율적인 관리 가능
- 시스템 처리율 향상 (처리 비용 감소)
- 스레드 간 데이터를 주고받는 것이 간단해지고 시스템 자원 소모 감소함
- 간단한 통신 방법으로 프로그램 응답시간 단축
- 스레드는 프로세스 내 스택 영역을 제외한 메모리 영역을 공유하기에 통신 비용이 적음
- 힙 영역을 공유하므로 데이터를 주고받을 수 있음

<br><br>

**+ 멀티 스레드 단점**

---

- 자원을 공유하기에 **동기화 문제**가 발생할 수 있음
    
    *하나의 스레드가 종료되면 전체 스레드가 종료될 수 있음*
    
    병목현상, 데드락 등
    
- 하나의 스레드에 문제가 발생하면 전체 프로세스에 영향을 끼침
- 주의깊은 설계가 필요하고 디버깅이 어려움
    
    불필요 부분까지 동기화하면, 대기시간으로 인해 성능 저하 발생
    
- 단일 프로세스 시스템의 경우 효과를 기대하기 어려움

<br><br>

**🔩 멀티 프로세스** Multi Process

---

**하나의 프로그램을 여러 개의 프로새스가 병렬적으로 작업을 수행하는 것**

여러 개의 프로세스가 서로 협력적으로 일을 처리하는 것

각 프로세스 간 메모리 구분이 필요하거나 독립된 주소 공간을 가져야 할 때 사용

<br><br>

**+ 멀티 프로세스 장점**

---

- 독립된 구조이기 때문에 안정성이 높음
- 여러 프로세스가 같이 작업하고 있기 때문에 하나의 프로세스가 죽는다 해도 문제가 확산되지 않음
    
    대신 다른 프로세스의 일을 자기가 더 해야하기 때문에 느려질 수 있음
    
- 여러 개의 프로세스가 처리되어야 할 때 동일한 데이터를 사용하고, 이러한 데이터를 하나의 디스크에 두고 모든 프로세서(CPU)가 이를 공유하면 비용적으로 저렴해짐

<br><br>

**+ 멀티 프로세스 단점**

---

- 멀티 스레드보다 많은 메모리 공간과 CPU시간 차지
- 독립된 메모리 영역이기 때문에 작업량이 많을 수록 (= Context Switching이 자주 일어나 주소 공간의 공유가 잦을 경우) 오버헤드 발생으로 성능 저하 발생 가능
    
    context switching 과정에서 캐시 메모리 초기화 등 무거운 작업이 진행되고 시간이 소모되는 등 오버헤드 발생
    

<br><br>

🔩 **멀티 프로세스 대신 멀티 스레드를 사용하는 이유**

---

1. 프로그램을 여러 개 작동시키는 것보다 하나의 프로그램 안에서 여러 작업을 해결하는 것이 효율적임
2. 컨텍스트 스위칭 시 Stack 영역만 초기화하면 됨
3. 프로세스 생성 시 자원을 할당하는 콜이 줄어 효율적으로 자원 관리 가능

<img width="720" alt="image" src="https://user-images.githubusercontent.com/107545016/212675750-9122bdb6-5a77-4f26-b2bd-9a44f0985289.png">

<br><br>

🔩 **예비 답변**

---

Q. 멀티 스레드와 멀티 프로세스에 대해 말해보세요.

멀티 스레드란 *하나의 프로세스를 여러 개의 스레드로 구성하여 자원을 공유하며 작업을 수행하는 것*이며, 멀티 프로세스란 *하나의 프로그램을 여러 개의 프로세스가 병렬적으로 작업을 수행하는 것*입니다. 멀티 프로세스는 주로 각 프로세스 간 메모리 구분이 필요하거나 독립된 주소 공간을 가져야 할 때 사용합니다.

<br>

Q. 멀티 스레드와 멀티 프로세스의 장단점에 대해 말해보세요.

**멀티 스레드는** 스레드 사이 작업량이 적어 컨텍스트 스위칭이 빠르고 자원의 효율적인 관리 가능하다는 장점이 있지만 하나의 스레드가 오류로 인해 종료되면 전체 스레드가 종료될 수 있는 동기화 문제를 가지고 있습니다.

**멀티 프로세스는** 독립된 구조이기 때문에 안정성이 높고 하나의 프로세스가 오류로 인해 종료되더라도 다른 프로세스에 영향을 끼치지 않는다는 장점이 있지만 멀티 스레드보다 많은 메모리 공간과 CPU시간을 차지한다는 문제가 있습니다. 

<br>

Q. 멀티 프로세스 대신 멀티 스레드를 사용하는 이유에 대해 말해보세요.

프로그램을 여러가지 작동시키는 것보단 하나의 프로그램 안에서 여러가지 작업을 해결하는 것이 효율적이며, 멀티 스레드는 컨텍스트 스위칭 시 Stack 영역만 초기화 하면 됩니다. 또한 프로세스 생성 시 자원을 할당하는 콜이 줄어들어 효율적으로 자원 관리할 수 있기 때문에 멀티 프로세스 대신 멀티 스레드를 사용합니다.

<br>

Q. 스레드마다 스택을 독립적으로 할당하는 이유는 무엇입니까

스택은 함수 호출시 전달되는 인자이자 되돌아갈 주소값 및 함수 내에서 선언하는 변수 등을 저장하기 위해 사용되는 메모리 공간입니다. 이러한 스택 메모리 공간이 독립적이라는 것은 독립적인 함수 호출이 가능하다는 것이고 이는 독립적인 실행 흐름이 추가되는 것임을 말합니다. 따라서 스레드 정의에 따라 *독립적인 실행 흐름을 추가*하기 위한 최소 조건으로 독립된 스택을 할당합니다.

<br>

Q. 스레드마다 PC 레지스터를 독립적으로 할당하는 이유는 무엇입니까

PC값은 스레드가 명령어의 어디까지 수행하였는지를 나타냅니다. 스레드는 CPU를 할당받았다가 스케쥴러에 의해 다시 선점되기 때문에 명령어가 연속적으로 수행되지 못해 *어느 부분까지 수행했는지 기억하기 위해서* PC 레지스터를 독립적으로 할당합니다.

<br><br>

🔩 **참고**

---

블로그

[멀티 스레드(Multi Thread) & 멀티 프로세스(Multi process)](https://velog.io/@xxhaileypark/%EB%A9%80%ED%8B%B0-%EC%8A%A4%EB%A0%88%EB%93%9CMulti-Thread-%EB%A9%80%ED%8B%B0-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4Multi-process)

[멀티 프로세스와 멀티 스레드](https://carnival.tistory.com/46)

[2. 프로세스와 스레드 (Process vs Thread)](https://goodmilktea.tistory.com/24)

[[OS] 프로세스(Process) vs. 스레드(Thread)](https://owlyr.tistory.com/6)

<br><br>
